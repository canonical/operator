type: charm
name: hookcmds
title: Test charm for ops.hookcmds
summary: Simple charm with enough functionality to exercise all of ops.hookcmds.
description: |
  A simple charm that contains secrets, storage, actions, and so forth so that
  the ops.hookcmds module can be tested against it in a real Juju model.

base: ubuntu@22.04
platforms:
  amd64:
  arm64:

parts:
  charm:
    plugin: charm
    source: .
    build-packages:
      - git
    build-snaps:
      - astral-uv

config:
  options:
    log-level:
      description: Configures the log level.
      default: "info"
      type: string
    another-option:
      description: Another option for the charm.
      type: int
    crash:
      description: Crash the charm with an exception.
      type: boolean
      default: false

actions:
  backup:
    description: Pretend to back up data for the charm.
    params:
      backup-location:
        description: Location to pretend to back up data to.
        type: string
        default: "/var/lib/juju/backup"
      days:
        description: Number of days to pretend to back up.
        type: integer
  open-port:
    description: Ask Juju to open a port.
    params:
      protocol:
        description: The protocol to use (e.g., tcp, udp).
        type: string
      port:
        description: The port to open.
        type: integer
  close-port:
    description: Ask Juju to close a port.
    params:
      protocol:
        description: The protocol to use (e.g., tcp, udp).
        type: string
      port:
        description: The port to close.
        type: integer
  opened-ports:
    description: List opened ports.
  test-status:
    description: Test setting and getting status.
  test-state:
    description: Test setting and getting state.
    params:
      value:
        description: Value to set in state.
        type: string
        default: "value"
  test-secrets:
    description: Test setting and getting secrets.
  get-storage:
    description: Provide information about the storage attached to the unit.
  add-storage:
    description: Add more storage to the unit.
    params:
      count:
        description: Number of additional storage units to add.
        type: integer
        default: 1
  set-peer-data:
    description: Set some data on the peer relation.
    params:
      data:
        description: Data to set on the peer relation.
        type: string
        default: "hello world!"

peers:
  peer:
    interface: chit-chat

resources:
  ping:
    type: file
    filename: ping.sh

storage:
  cache:
    type: filesystem
    description: A place to stash stuff.
    multiple:
        range: 1-3
